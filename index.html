<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XeinStore - Digital Game Keys</title>
<style>
    body { margin:0; font-family:sans-serif; background:#f5f5f5; }
    header { background:#667eea; color:white; padding:1rem 2rem; display:flex; justify-content:space-between; align-items:center; }
    header h1 { margin:0; font-size:1.5rem; }
    header .cart-icon { cursor:pointer; position:relative; font-size:1.2rem; }
    header .cart-count { position:absolute; top:-10px; right:-10px; background:red; color:white; border-radius:50%; padding:2px 6px; font-size:.8rem; }
    main { padding:2rem; }
    .product-card { background:white; padding:1rem; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); margin-bottom:1rem; display:flex; gap:1rem; align-items:center; }
    .product-image { font-size:2rem; }
    .product-info { flex:1; }
    .product-title { font-weight:700; font-size:1.1rem; }
    .product-platform { font-size:.9rem; color:#666; margin-bottom:.5rem; }
    .duration-selector select { padding:.3rem; margin-bottom:.5rem; }
    .duration-price { font-weight:600; margin-bottom:.5rem; }
    .add-to-cart { background:#667eea; color:white; border:none; padding:.5rem 1rem; border-radius:6px; cursor:pointer; }
    /* Cart Sidebar */
    #cart-sidebar { position:fixed; right:-350px; top:0; width:350px; height:100%; background:white; box-shadow:-3px 0 6px rgba(0,0,0,0.1); padding:1rem; transition:.3s; overflow-y:auto; z-index:1000; }
    #cart-sidebar.open { right:0; }
    #cart-sidebar h2 { margin-top:0; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; margin-bottom:.8rem; border-bottom:1px solid #eee; padding-bottom:.4rem; }
    .cart-item button { cursor:pointer; }
    #cart-total { font-weight:700; margin-top:1rem; text-align:right; }
    #checkout-btn { background:#48bb78; color:white; border:none; padding:.6rem 1rem; width:100%; border-radius:6px; cursor:pointer; margin-top:1rem; display:none; }
    /* Checkout Modal */
    #checkout-modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:none; justify-content:center; align-items:center; z-index:2000; }
    #checkout-modal.open { display:flex; }
    #checkout-modal .modal-content { background:white; padding:2rem; border-radius:8px; width:90%; max-width:400px; position:relative; }
    #checkout-modal h2 { margin-top:0; }
    #checkout-modal .close-btn { position:absolute; top:10px; right:10px; cursor:pointer; font-size:1.2rem; }
    #order-summary div { margin-bottom:.5rem; }
    /* Notification */
    .notification { position:fixed; background:#667eea; color:white; padding:.5rem 1rem; border-radius:6px; opacity:0.9; font-size:.9rem; z-index:3000; }
    /* Note box */
    .note-box { background:#fffae6; border-left:4px solid #ffcc00; padding:1rem; margin-bottom:1rem; font-weight:600; }
</style>
</head>
<body>

<header>
    <h1>XeinStore</h1>
    <div class="cart-icon" onclick="toggleCart()">ðŸ›’ <span id="cart-count">0</span></div>
</header>

<main>
    <div class="note-box">
        NOTE: Please be reminded to screenshot your crypto payment before proceeding.
    </div>
    <div id="products-grid"></div>
</main>

<!-- Cart Sidebar -->
<div id="cart-sidebar">
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <div id="cart-total"></div>
    <button id="checkout-btn" onclick="openCheckoutModal()">Checkout</button>
</div>

<!-- Checkout Modal -->
<div id="checkout-modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeCheckoutModal()">Ã—</span>
        <h2>Checkout</h2>
        <div id="order-summary"></div>
        <div style="margin:1rem 0;">
            <label>Telegram Username:</label>
            <input type="text" id="telegram-username" placeholder="@username" style="width:100%; padding:.5rem; border-radius:6px; border:1px solid #ccc;">
        </div>
        <div style="margin:1rem 0;">
            <strong>Wallet Address:</strong>
            <div style="background:#f5f5f5;padding:.5rem;border-radius:6px;">YOUR_WALLET_ADDRESS_HERE</div>
        </div>
        <button onclick="proceedToReceipt()" style="background:#667eea;color:white;padding:.6rem 1rem;border:none;width:100%;border-radius:6px;">I Paid</button>
    </div>
</div>

<script>
    // ---------- PRODUCTS ----------
    const products = [
        { id:1, title:"Xein Pubg Key", platform:"Digital Key", pricing:{"1_day":{price:5.00},"3_days":{price:8.00},"7_days":{price:12.00},"30_days":{price:23.00}}, icon:"ðŸŽ¯" },
        { id:2, title:"Xein Delta Force Key", platform:"Digital Key", pricing:{"1_day":{price:4.00},"3_days":{price:7.00},"7_days":{price:11.00},"30_days":{price:22.00}}, icon:"âš¡" }
    ];
    let cart = [];

    function renderProducts() {
        const grid = document.getElementById('products-grid');
        grid.innerHTML = '';
        products.forEach(product => {
            const card = document.createElement('div');
            card.className = 'product-card';
            let optionsHTML = '';
            for (const [key, v] of Object.entries(product.pricing)) {
                const label = key.replace(/_/g,' ').replace(/\b\w/g,l => l.toUpperCase());
                optionsHTML += `<option value="${key}">${label} - $${v.price}</option>`;
            }
            card.innerHTML = `
                <div class="product-image">${product.icon}</div>
                <div class="product-info">
                    <div class="product-title">${product.title}</div>
                    <div class="product-platform">${product.platform}</div>
                    <div class="duration-selector">
                        <select id="duration-${product.id}" onchange="updatePrice(${product.id})">
                            ${optionsHTML}
                        </select>
                        <div class="duration-price" id="price-${product.id}">$${product.pricing["1_day"].price} USDT</div>
                    </div>
                    <button class="add-to-cart" onclick="addToCart(${product.id})">Add to Cart</button>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    function updatePrice(productId) {
        const select = document.getElementById(`duration-${productId}`);
        const priceDisplay = document.getElementById(`price-${productId}`);
        const product = products.find(p => p.id===productId);
        priceDisplay.textContent = `$${product.pricing[select.value].price} USDT`;
    }

    function addToCart(productId) {
        const product = products.find(p => p.id===productId);
        const select = document.getElementById(`duration-${productId}`);
        const selectedDuration = select.value;
        const price = product.pricing[selectedDuration].price;

        const existing = cart.find(i => i.id===productId && i.selectedDuration===selectedDuration);
        if (existing) existing.quantity++;
        else cart.push({ id:product.id, title:product.title, selectedDuration, durationLabel:select.options[select.selectedIndex].text, price, quantity:1 });

        updateCartUI();
        showNotification('Added to cart âœ…');
    }

    function updateCartUI() {
        const cartCount = document.getElementById('cart-count');
        const cartItems = document.getElementById('cart-items');
        const cartTotalEl = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');

        const totalItems = cart.reduce((s,i)=>s+i.quantity,0);
        const totalPrice = cart.reduce((s,i)=>s + i.price*i.quantity,0);

        cartCount.textContent = totalItems;

        if (cart.length === 0) {
            cartItems.innerHTML = '<p style="text-align:center;color:#666;padding:2rem;">Your cart is empty</p>';
            cartTotalEl.style.display = 'none';
            checkoutBtn.style.display = 'none';
        } else {
            let html = '';
            for (const item of cart) {
                html += `
                    <div class="cart-item">
                        <div style="flex:1;">
                            <div style="font-weight:700;">${item.title}</div>
                            <div style="font-size:.9rem;color:#666;">${item.durationLabel}</div>
                            <div style="font-size:.9rem;color:#667eea;">$${item.price} each x${item.quantity}</div>
                        </div>
                        <div style="display:flex;flex-direction:column;gap:.4rem;">
                            <button onclick="decreaseQty(${item.id},'${item.selectedDuration}')">âˆ’</button>
                            <button onclick="increaseQty(${item.id},'${item.selectedDuration}')">+</button>
                            <button onclick="removeFromCart(${item.id},'${item.selectedDuration}')">Remove</button>
                        </div>
                    </div>
                `;
            }
            cartItems.innerHTML = html;
            cartTotalEl.style.display = 'block';
            cartTotalEl.textContent = `Total: $${totalPrice.toFixed(2)} USDT`;
            checkoutBtn.style.display = 'block';
        }
    }

    function decreaseQty(id,dur) {
        const idx = cart.findIndex(i=>i.id===id && i.selectedDuration===dur);
        if (idx>-1) {
            cart[idx].quantity = Math.max(1, cart[idx].quantity-1);
            updateCartUI();
        }
    }
    function increaseQty(id,dur) {
        const idx = cart.findIndex(i=>i.id===id && i.selectedDuration===dur);
        if (idx>-1) { cart[idx].quantity++; updateCartUI(); }
    }
    function removeFromCart(id,dur) {
        cart = cart.filter(i => !(i.id===id && i.selectedDuration===dur));
        updateCartUI();
    }

    function toggleCart() {
        document.getElementById('cart-sidebar').classList.toggle('open');
    }

    // ---------- Checkout ----------
    function openCheckoutModal() {
        if (cart.length === 0) { alert('Cart is empty.'); return; }
        document.getElementById('checkout-modal').classList.add('open');
        renderOrderSummary();
    }

    function closeCheckoutModal() {
        document.getElementById('checkout-modal').classList.remove('open');
    }

    function renderOrderSummary() {
        const el = document.getElementById('order-summary');
        let html = '<div style="font-weight:800;margin-bottom:.5rem;">Order Summary</div>';
        const items = cart.map(i => `<div style="display:flex;justify-content:space-between;"><div>${i.title} (${i.durationLabel}) x${i.quantity}</div><div>$${(i.price*i.quantity).toFixed(2)}</div></div>`).join('');
        const total = cart.reduce((s,i)=>s + i.price*i.quantity,0).toFixed(2);
        html += items;
        html += `<div style="border-top:1px dashed #eee;margin-top:.6rem;padding-top:.6rem;font-weight:800;display:flex;justify-content:space-between;"> <div>Total</div><div>$${total} USDT</div></div>`;
        el.innerHTML = html;
    }

    function proceedToReceipt() {
        const telegramUsername = document.getElementById('telegram-username').value.trim();
        if (!telegramUsername) { alert('Please enter your Telegram username'); return; }
        const orderId = 'XSN' + Date.now();
        const total = cart.reduce((s,i)=>s + i.price*i.quantity,0).toFixed(2);
        const items = cart.map(i => ({ title:i.title, duration:i.durationLabel, quantity:i.quantity, price:i.price }));
        const receiptData = { orderId, telegramUsername, items, total };
        localStorage.setItem('currentReceipt', JSON.stringify(receiptData));
        window.location.href = 'receipt.html';
    }

    // ---------- Recent Purchase Notification ----------
    const sampleUsernames = ["gamer123", "proplayer99", "traderX", "aliceBTC", "cryptoFan88", "levelUpJoe", "ninja007", "dragonSlayer"];
    function showNotification(msg) {
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.style.bottom='20px';
        notification.style.left='20px';
        notification.style.top='auto';
        notification.textContent = msg;
        document.body.appendChild(notification);
        setTimeout(()=>{ notification.remove(); }, 5000);
    }

    function showRandomPurchase() {
        const username = sampleUsernames[Math.floor(Math.random()*sampleUsernames.length)];
        const product = products[Math.floor(Math.random()*products.length)];
        const minutesAgo = Math.floor(Math.random()*59)+1;
        showNotification(`${username} just bought ${product.title} ${minutesAgo} minutes ago`);
        // random next show
        setTimeout(showRandomPurchase, (Math.random()*15000)+10000);
    }

    // ---------- Init ----------
    document.addEventListener('DOMContentLoaded', () => {
        renderProducts();
        updateCartUI();
        showRandomPurchase();
    });
</script>

</body>
</html>
